## CDN

### CDN是什么

CDN（Content Delivery Network），即内容分发网路其基本思路是尽可能避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容传输的更快、更稳定。
通过在网络各处放置节点服务器所构成的在现有的互联网基础之上的一层智能虚拟网络，CDN系统能够实时地根据网络流量和各节点的连接、
负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上。其目的是使用户可就近取得所需内容，解决 Internet网络拥挤的状况，
提高用户访问网站的响应速度。

C 内容，专注于静态资源的分发和访问，比如一张图片，文本，视频等等，任何文件存储的，为了提高载互联网上的访问速度和质量，
都可以将这个资源部署到CDN这个网络上。

D 分发，也就是如何让刚才提到的那些内容快速的部署在这个网络上，从而快速味客户服务，还有一层重要的含义是用户的快速访问与就近接入，分发的目的是为了用户更好的体验

N 网络，是部署在世界各地的一大堆服务器，这些服务器基于当前互联网的基础架构在其上层再构成一个网络，这个网络负责内容分发。

- CDN的作用：

CDN厂商构建了一个基于互联网数量巨大的服务器，专注于内容和资源的分发，方便用户快速访问，提升用户体验的一个内容网络。

- CDN的基本原理：

CDN是将源站的内容分发至各个节点，使用户可以就近取得所需要内容，提高用户访问的响应速度和成功率。解决分布、贷款、服务器性能带来的访问延迟问题，适用于
站点加速、点播、直播等场景。

- 基础架构：

1.当用户点击网站页面上的内容URL，经过本地DNS系统解析，DNS系统会最终将域名的解析权交给CNAME指向的CDN专用DNS服务器。

2.CDN的DNS服务器将CDN的全局负载均衡设备IP地址返回用户。

3.用户向CDN的全局负载均衡设备发起内容URL访问请求。

4.CDN全局负载均衡设备根据用户IP地址，以及用户请求的内容URL，选择一台用户所属区域的区域负载均衡设备，告诉用户向这台设备发起请求。

5.区域负载均衡设备会为用户选择一台合适的缓存服务器提供服务，选择的依据包括：根据用户IP地址，判断哪一台服务器距用户最近；根据用户所请求的URL中携带的内容名称，
判断哪一台服务器上有用户所需内容；查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。基于以上这些条件的综合分析之后，
区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的IP地址。

6.全局负载均衡设备把服务器的IP地址返回给用户。

7.用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，
而区域均衡设备依然将它分配给了用户，那么这台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地