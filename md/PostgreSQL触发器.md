# PostgreSQL触发器

## 概述

一个触发器是一种声明，告诉数据库应该在执行特定操作的时候执行特定的函数。触发器可以附件到表、视图和外部表上。
    
在表活外部表上，触发器可以定义在一个INSERT,UPDATE或DELETE命令之前或之后执行，要么是对每行执行一次，
要么是对每条SQL语句执行一次。如果某列在UPDATE语句的set子句中被提及，则UPDATE触发器再次被触发。触发器可以为TRUNCATE
语句触发。如果发生触发器事件，那么将在合适的时刻调用触发器函数以处理改事件。外部表不支持TRANCATE语句。

- 创建

CREATE TRIGGER创建触发器

PostgreSQL触发器类型：

## 分类

- 根据影响范围分类

    - 行级触发器
    
    对于一个每行的触发器，对于触发触发器的语句所修改的每一行都会调用一次触发器行数。

    - 语句级触发器
    
    一个每语句的触发器对于其触发语句，只被调用一次，而不管该语句影响了多少行数据。特别地，一个不影响任何行的语句仍然会导致任何可用每语句的触发器执行。

注意：在TRUNCATE上的触发器可能只能在语句级别定义。 触发之前或之后的视图，触发器只能在语句级别定义， 然而非INSERT, UPDATE或者 DELETE触发的触发器在行级别定义。

- 根据触发器触发的时机分类

    - BEFORE 触发器（表，外部表）
    
    该触发器可以被定义在INSERT,UPDATE或DELETE操作之前执行。
    
    - AFTER 触发器（表，外部表）
    
    该触发器可以被定义在INSERT,UPDATE或DELETE操作之后执行。
    
    - INSTEAD OF 触发器（只能定义在视图上，且只能定义为行级）
    
    在视图上，触发器可以被定义来取代INSERT,UPDATE,DELETE操作的执行。INSTEAD OF触发器对视图中被修改的每一行触发一次。触发器的职责就是对底层的基本表执行必要的修改，
    在合适的时候返回被修改的行以便显示在视图中。视图上的触发器也可以被定义为每个SQL语句执行一次，在INSERT,UPDATE或 DELETE操作之前或之后。

