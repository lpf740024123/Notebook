# Message Queue消息队列
#### 消息队列的特点：
- 异步处理
    非系统核心流程异步化，提高系统响应性能。
    
- 解耦

    - 每个成员不必受其他成员影响，可以独立自主，只需要通过容器来联系。
    - 消消费者可以随意增加，不需要修改消息发送者的代码。生产者的成功不依赖与消费者
    - 不强依赖于本系统的非核心流程，对于非核心流程，可以放到消息队列中，消费者可以按需消费。
   
- 提速

    - 因为是异步的，所以不需要等待，
- 广播

    - 一个生产者生产的一个消息可以供多个消费者使用。生产者只需要把消息放入到队列中，至于谁订阅是消费者的事情。
    
- 流量削峰与流控

    - 生产者值负责生产，不需要监督消费者怎么处理消息。生产者无需一直等待消费者完成。
    - 当上下游系统处理能力存在差距的时候，利用消息队列做一个通用的“漏斗“。在下游有能力处理的时候，在进行分发。
    
#### 消息队列的成本：
- 引入复杂度

    需要容器存储生产者生产的消息，同时需要保证消息的安全性。
- 暂时的不一致性

    由于生产者生产完之后就不再监督消费者如何处理消息，
    生产者会默认消费者会按照理想的方式处理消息，
    但是消费者需要时间处理这些消息，
    所以中间会存在暂时的不一致性。当然消费者最终会处理这些消息，
    达到生产者理想的状态，这就是所谓的最终一致性。
#### 消息队列的应用条件
- 生产者不需要从消费者出获得反馈

    引入消息队列之前的而直接调用，
    其接口的返回值应该为空，
    这才让明明消费者还没有处理生产者生产的消息，
    生产者生产完之后就默认完成了，继续执行其他操作，达到异步的效果。
- 允许短暂的不一致性

    生产者在生产完之后就不再管理生产的消息，
    默认完成继续执行其他操作，
    此时消费者还没有执行操作，
    所以会存在短暂的不一致性，
    系统需要容忍短暂的不一致性。
- 使用消息队列之后有效果

使用消息队列之后，解耦、提速、广播、削峰这些给系统带来的收益，
超过放置消息的容器和监管这些消息完成的成本。
